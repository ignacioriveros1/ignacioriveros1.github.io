---
title: "Stargazer: A solution to produce amazing academic tables"
output: 
  html_document:
    keep_md: False
    toc: yes
---

## Introduction
- Importance of maintaining the tables automatized
  - Avoid typing errors
  - Help your future self: numbers changes while working on projects, 
  - Reproducible Research

- My experience producing tables
  - Academic Research in Economics <->  Regressions Tables
  - Stata + Latex

- Some difficulties that I have found with my past workflows 
  - Million .tex files with the tables
  - Tricky to customize

- Discovered `stargazer`:
  - Your table is produced with the model objects that are outputs of your estimations.
  - Almost every detail of the tables are customizable

## Using `stargazer`
### Data set
- Brief description of the dataset.
**Source**: [Swiss Fertility and Socioeconomic Indicators (1888)](https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/swiss.html).
```{r Dataset}
data('swiss')
head(swiss)
```

### Basic Usage
- Description of what I'm trying to explain.
- Stargazer support a broad variety of models.
- For formatting reasons, we are using `html` format.

```{r Model}
model_1 <- lm(Fertility ~ Catholic + Infant.Mortality, data = swiss)
model_2 <-
  lm(Fertility ~ Catholic + Infant.Mortality + Agriculture, data = swiss)
model_3 <-
  lm(Fertility ~ Catholic + Infant.Mortality + Agriculture + Examination,
     data = swiss)

# Checking a summary
summary(model_1)
```


- Really easy to use.

```{r Default Option, results='asis', warning=FALSE, message=FALSE}
# install.packages('stargazer')
library(stargazer)

stargazer(model_1, model_2, model_3, type = "html")
```

### Editing Headers
- Within the function, you have many options to format the header of your table. Here I present some options, but there are many more! Check the docs.

```{r Editing Headers - Change models labels,  results='asis'}
stargazer(
  model_1,
  model_2,
  model_3,
  type = "html",
  dep.var.caption  = "My new caption",
  dep.var.labels   = "Fertility (Live births per 1,000 inhabitants)",
  column.labels = c("OLS", "OLS", "OLS"),
  dep.var.labels.include = TRUE,
  # By default is TRUE, change to FALSE to supress the dep var labels,
  model.numbers = TRUE
  # By default is TRUE, change to FALSE to supress models' numbers.
)
```

#### Multicolumns
- Example when you have more than one estimation model (e.g. OLS and WLS).
```{r Editing Headers - Multicolumn in col labels,  results='asis'}
stargazer(
  model_1,
  model_2,
  model_3,
  type = "html",
  column.labels   = c("OLS", "OLS"),
  column.separate = c(2, 1) 
  # First label for the first two columns and the second for the third one
)
```

### Changing Covariates' Labels
- Use a vector of strings to format your column names.
- IMPORTANT: Always check the order of the original coefficients' labels since you may label incorrectly some variables.
```{r Changing Covariates Labels,  results='asis'}
labels <- c(
  'Catholic (% as opposed to protestant)',
  'Infant Mortality	*live births who live less than 1 year)',
  'Agriculture	(% of males involved in agriculture as occupation',
  'Examination	(% draftees receiving highest mark on army examination)'
)

stargazer(model_1,
          model_2,
          model_3,
          type = "html",
          covariate.labels = labels)
```

### Styles
- Format tables according to journals' styles.
- Check styles in this [link](https://rdrr.io/cran/stargazer/man/stargazer_style_list.html){:target="_blank"}

```{r Styles, results='asis', warning=FALSE, message=FALSE}
stargazer(model_1, model_2, model_3, type = "html", style='aer')
```


### Customizing Stats of the Table
- Check documentation for formats allowed

```{r Editing Stats of the Table - Parenthesis Paramenters,  results='asis'}
# rep_format <- "vcp*" # variable name, coefficient, p value and stars
rep_format <- "vct" # variable name, coefficient, t statistic without stars

stargazer(model_1,
          model_2,
          model_3,
          type = "html",
          report = rep_format) 
```

### Using personalized standard errors and p-values
- Example of the robust standard errors, or clustered.
```{r Editing Stats of the Table - Using personalized standard errors and p-values,  results='asis', warning=FALSE, message=FALSE}
# install.packages('lmtest')
# install.packages('sandwich')

library("lmtest") # coeftest
library("sandwich") # vcovHC

# Robust standard errors
inference_m1 <-
  coeftest(model_1, vcov = vcovHC(model_1, type = "HC0"))
inference_m2 <-
  coeftest(model_2, vcov = vcovHC(model_2, type = "HC0"))
inference_m3 <-
  coeftest(model_3, vcov = vcovHC(model_3, type = "HC0"))

stargazer(
  model_1,
  model_2,
  model_3,
  se = list(NULL, inference_m2[, 2], inference_m3[, 2]), # If NULL use model_* errors
  p = list(NULL, inference_m2[, 4], inference_m3[, 4]), # If NULL use model_* pvalues
  omit.stat = "f",
  type = "html"
) 
```


### Customizing Footer Stats
- [List of statistics](https://www.rdocumentation.org/packages/stargazer/versions/5.2.2/topics/stargazer_stat_code_list){:target="_blank"}
```{r Editing Footer and Notes - Footer stats,  results='asis'}
stargazer(
  model_1,
  model_2,
  model_3,
  type = "html",
  keep.stat = c("n", "rsq")
) 
```

### Adding new lines
- Example when using Fixed Effects or Not reported variables in the table
```{r Editing Footer and Notes - Adding lines,  results='asis'}

stargazer(
  model_1,
  model_2,
  model_3,
  type = "html",
  keep.stat = c("n", "rsq"),
  add.lines = list(
    c("County Fixed Effect", "No", "Yes", 'Yes'),
    c("Time Fixed Effect", "Yes", "No", 'Yes')
  )
) 
```

### Customizing Notes
- I personally, don't like how the labels are worked in the function.
```{r Editing Footer and Notes - Editing Notes,  results='asis'}

stargazer(
  model_1,
  model_2,
  model_3,
  type = "html",
  keep.stat = c("n", "rsq"),
  add.lines = list(
    c("County Fixed Effect", "No", "Yes", 'Yes'),
    c("Time Fixed Effect", "Yes", "No", 'Yes')
  ),
  notes.label = 'Comments', # Edit here the label
  notes = 'Own elaboration based on swiss data. Significance levels: * 90%, ** 95%, *** 99%.',
  notes.append = FALSE, # TRUE append the significance levels
  notes.align = 'l' # c center, r right
) 
```


### Stargazer and LaTeX
- `stargazer` + $\LaTeX$ = Winner Combination! 
```{r Stargazer and LaTeX - Editing Notes, warning=FALSE, message=FALSE}
stargazer(
  model_1,
  model_2,
  model_3,
  type = "latex",
  # out = 'path/of/your/table.tex'
  header = FALSE, # If TRUE, stargazer print the header with the citation and package info
  float = TRUE # If FALSE, the function don't returns the table in a table environment
) 
```


## Final Thoughts
- Great tool for scientific research!
- `python` version is in `pip`!
- Combination with `rmarkdown` is amazing!

## References
- [`stargazer`: beautiful LATEX, HTML and ASCII tables from R statistical output](https://cran.r-project.org/web/packages/stargazer/vignettes/stargazer.pdf){:target="_blank"}
- [A Stargazer Cheatsheet](https://www.jakeruss.com/cheatsheets/stargazer/){:target="_blank"}
- [`stargazer` function - RDocumentation](https://www.rdocumentation.org/packages/stargazer/versions/5.2.2/topics/stargazer){:target="_blank"}
- [Heteroskedasticity Robust Standard Errors in R](https://www.r-econometrics.com/methods/hcrobusterrors/){:target="_blank"}
- []